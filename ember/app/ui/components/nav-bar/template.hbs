<nav
  class="
    nav-bar uk-navbar-container uk-navbar-transparent
    uk-padding uk-padding-remove-top uk-padding-remove-bottom
  "
  uk-navbar
>
  <LinkTo @route="application" class="uk-navbar-item uk-logo uk-text-primary uk-padding-remove">
    {{#if @logo}}
      <img class="nav-bar-logo" src={{@logo}} alt={{@text}} />
    {{else}}
      {{@text}}
    {{/if}}
  </LinkTo>

  <div class="uk-navbar-left uk-visible@m">
    <UkTab as |tab|>
      <tab.link-item @route="cases">
        {{t "nav.documents"}}
      </tab.link-item>
      {{#if (can "list identity")}}
        <tab.link-item @route="identities">
          {{t "nav.identities"}}
        </tab.link-item>
      {{/if}}
      {{#if (can "list interest")}}
        <tab.link-item @route="interests">
          {{t "nav.interests"}}
        </tab.link-item>
      {{/if}}
      {{#if (can "list membership-role")}}
        <tab.link-item @route="membership-roles">
          {{t "nav.roles"}}
        </tab.link-item>
      {{/if}}
      {{#if (can "list snippets")}}
        <tab.link-item @route="snippets">
          {{t "nav.snippets"}}
        </tab.link-item>
      {{/if}}

      {{#if (can "list form-builder")}}
        <tab.link-item @route="form-builder">
          {{t "nav.form-builder"}}
        </tab.link-item>
      {{/if}}

      <tab.link-item @route="profile">
        {{t "nav.profile"}}
      </tab.link-item>

      <tab.item class="language-select">
        <a class="uk-link-reset" href="#">{{this.intl.locale}} <UkIcon @icon="chevron-down"/></a>
        <ul uk-dropdown="pos: bottom-justify" class="uk-list uk-list-collapse uk-padding-small">
          {{#each this.intl.locales as |locale|}}
            <li>
              <a class="uk-link-text" {{on "click" (fn this.setLocale locale)}} href="#">{{locale}}</a>
            </li>
          {{/each}}
        </ul>
      </tab.item>
      {{#if (can "list snippets")}}
        <tab.link-item @route="snippets">
          {{t "nav.snippets"}}
        </tab.link-item>
      {{/if}}

      <tab.link-item @route="form-builder">
        {{t "nav.form-builder"}}
      </tab.link-item>
    </UkTab>
  </div>
  <div class="uk-navbar-right uk-visible@m">
    <ul class="uk-navbar-nav">
      {{#if this.session.isAuthenticated}}
        <li>
          <a href="#" {{on "click" this.invalidateSession}}>
            {{t "nav.logout"}}
          </a>
        </li>
        <li class="uk-flex uk-flex-middle">
          <button
            class="uk-icon-button uk-button-default"
            type="button"
            uk-toggle="target: #offcanvas-snippets"
            uk-icon="file-text"
          ></button>
        </li>
      {{else}}
        <li>
          <LinkTo @route="login">
            {{t "nav.login"}}
          </LinkTo>
        </li>
      {{/if}}
    </ul>
  </div>

  <div class="uk-navbar-right uk-hidden@m">
    <button
      class="uk-icon-button uk-button-default uk-margin-small-right"
      type="button"
      uk-toggle="target: #offcanvas-nav"
      uk-icon="menu"
    ></button>
    <button
      class="uk-icon-button uk-button-default"
      type="button"
      uk-toggle="target: #offcanvas-snippets"
      uk-icon="file-text"
    ></button>
  </div>
</nav>

<div id="offcanvas-nav" uk-offcanvas="flip: true; overlay: true">
  <div class="uk-offcanvas-bar uk-flex uk-flex-column">
    <button class="uk-offcanvas-close" type="button" uk-close></button>

    <ul class="uk-nav uk-nav-primary uk-nav-center uk-margin-auto-vertical">
      <li>
        <LinkTo @route="cases" uk-toggle="target: #offcanvas-nav">
          {{t "nav.documents"}}
        </LinkTo>
      </li>

      <li class="uk-nav-header">{{t "nav.admin"}}</li>
      {{#if (can "list identity")}}
        <li>
          <LinkTo @route="identities" uk-toggle="target: #offcanvas-nav">
            {{t "nav.identities"}}
          </LinkTo>
        </li>
      {{/if}}
      {{#if (can "list interest")}}
        <li>
          <LinkTo @route="interests" uk-toggle="target: #offcanvas-nav">
            {{t "nav.interests"}}
          </LinkTo>
        </li>
      {{/if}}
      {{#if (can "list membership-role")}}
        <li>
          <LinkTo @route="membership-roles" uk-toggle="target: #offcanvas-nav">
            {{t "nav.roles"}}
          </LinkTo>
        </li>
      {{/if}}
      {{#if (can "list snippets")}}
        <li>
          <LinkTo @route="snippets" uk-toggle="target: #offcanvas-nav">
            {{t "nav.snippets"}}
          </LinkTo>
        </li>
      {{/if}}
      {{#if (can "list form-builder")}}
        <li>
          <LinkTo @route="form-builder" uk-toggle="target: #offcanvas">
            {{t "nav.form-builder"}}
          </LinkTo>
        </li>
      {{/if}}

      <li class="uk-nav-header">{{t "nav.account"}}</li>
      <li>
        <LinkTo @route="profile" uk-toggle="target: #offcanvas">
          {{t "nav.profile"}}
        </LinkTo>
      </li>
      <li>
        <a href="#" {{on "click" this.invalidateSession}} uk-toggle="target: #offcanvas">
          <span class="uk-margin-small-right" uk-icon="icon: sign-out"></span>
          {{t "nav.logout"}}
        </a>
      </li>

      <li class="language-select-offcanvas">
        <a class="uk-link-reset uk-text-uppercase" href="#">{{this.intl.locale}} <UkIcon @icon="chevron-down"/></a>
        <ul uk-dropdown="pos: bottom-justify; mode: click" class="uk-list uk-list-collapse uk-padding-small">
          {{#each this.intl.locales as |locale|}}
            <li>
              <a class="uk-link-text uk-text-uppercase" {{on "click" (fn this.setLocale locale)}} href="#">{{locale}}</a>
            </li>
          {{/each}}
        </ul>
      </li>
        <LinkTo @route="form-builder" uk-toggle="target: #offcanvas">
          {{t "nav.form-builder"}}
        </LinkTo>
      </li>

      <li class="uk-nav-header">{{t "nav.account"}}</li>
      {{#if this.session.isAuthenticated}}
        <li>
          <a href="#" {{on "click" this.invalidateSession}} uk-toggle="target: #offcanvas-nav">
            <span class="uk-margin-small-right" uk-icon="icon: sign-out"></span>
            {{t "nav.logout"}}
          </a>
        </li>
      {{else}}
        <li>
          <LinkTo @route="login" uk-toggle="target: #offcanvas-nav">
            {{t "nav.login"}}
          </LinkTo>
        </li>
      {{/if}}
    </ul>
  </div>
</div>

<div id="offcanvas-snippets" uk-offcanvas="flip: true; overlay: true">
  <div class="uk-offcanvas-bar uk-flex uk-flex-column">
    <button class="uk-offcanvas-close" type="button" uk-close></button>

    <h3>{{t "nav.snippets"}}</h3>

    <div class="uk-margin">
      <label class="uk-form-label" for="form-search">
        {{t "page.snippets.index.search"}}
      </label>
      <input
        class="uk-input"
        id="form-search"
        type="search"
        value={{this.searchTerm}}
        {{on "input" this.search}}
      >
    </div>

    <ul uk-accordion="multiple: true">
      {{#each this.snippets as |snippet|}}
        <li class="uk-margin">
          <a class="uk-accordion-title" href="#">{{snippet.title}}</a>
          <div class="uk-accordion-content">
            {{#each this.intl.locales as |locale|}}
              <textarea id="snippet-{{snippet.id}}-{{locale}}" class="uk-textarea" readonly="">{{get snippet.bodyObject locale}}</textarea>
              <CopyButton
                @clipboardTarget="#snippet-{{snippet.id}}-{{locale}}"
                @success={{this.onCopySuccess}}
                @error={{this.onCopyError}}
                class="uk-button uk-width-1-1 uk-button-default uk-margin"
              >
                {{t "nav.snippet.hint" lang=locale}}
              </CopyButton>
            {{/each}}
          </div>
        </li>
      {{else}}
        <p>{{t "page.snippets.index.empty"}}</p>
      {{/each}}
    </ul>
  </div>
</div>
